<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BizPal - Comprehensive Fix Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
            font-weight: bold;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
        }
        .status.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>üîß BizPal - Comprehensive Fix Test</h1>
    <p>Detta √§r en test-sida f√∂r att verifiera att alla fixar fungerar korrekt.</p>

    <div class="test-section">
        <h2>‚úÖ Fixar som har gjorts:</h2>
        <ul>
            <li><strong>"Prova free" knappen</strong> - Nu skapar den ett demo-konto ist√§llet f√∂r ett riktigt konto</li>
            <li><strong>Typo fixad</strong> - "Personligad" ‚Üí "Personlig"</li>
            <li><strong>Demo-l√§ge</strong> - Korrekt hantering av demo-sessioner</li>
            <li><strong>Onboarding</strong> - Alla knappar och progress fungerar</li>
            <li><strong>BizPal Context</strong> - Felhantering och fallback UI</li>
            <li><strong>Limits error</strong> - S√§kerhetskontroller f√∂r plan-gr√§nser</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>üß™ Test-funktioner:</h2>
        
        <h3>1. Demo-konto test</h3>
        <button class="test-button" onclick="testDemoAccount()">Testa "Prova free" funktionalitet</button>
        <div id="demo-test-result"></div>

        <h3>2. Onboarding test</h3>
        <button class="test-button" onclick="testOnboarding()">G√• till onboarding</button>
        <button class="test-button" onclick="clearOnboarding()">Rensa onboarding data</button>
        <div id="onboarding-test-result"></div>

        <h3>3. Dashboard test</h3>
        <button class="test-button" onclick="testDashboard()">G√• till dashboard</button>
        <div id="dashboard-test-result"></div>

        <h3>4. Demo-l√§ge test</h3>
        <button class="test-button" onclick="enableDemoMode()">Aktivera demo-l√§ge</button>
        <button class="test-button" onclick="disableDemoMode()">Inaktivera demo-l√§ge</button>
        <div id="demo-mode-test-result"></div>

        <h3>5. Status kontroll</h3>
        <button class="test-button" onclick="checkStatus()">Kontrollera nuvarande status</button>
        <div id="status-result"></div>
    </div>

    <div class="test-section">
        <h2>üìã Instruktioner f√∂r testning:</h2>
        <ol>
            <li><strong>Testa "Prova free"</strong> - Klicka p√• knappen och verifiera att den skapar ett demo-konto</li>
            <li><strong>Testa onboarding</strong> - G√• igenom hela onboarding-fl√∂det och verifiera att alla knappar fungerar</li>
            <li><strong>Testa dashboard</strong> - Verifiera att du kommer till dashboard efter onboarding</li>
            <li><strong>Testa demo-l√§ge</strong> - Aktivera och inaktivera demo-l√§ge</li>
            <li><strong>Kontrollera status</strong> - Se vad som finns i localStorage</li>
        </ol>
    </div>

    <script>
        function showResult(elementId, message, type = 'info') {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function testDemoAccount() {
            // Simulate the "Prova free" button functionality
            const demoUser = {
                id: `demo-${Date.now()}`,
                email: 'test@demo.se',
                user_metadata: {
                    full_name: 'Test Demo Anv√§ndare'
                },
                app_metadata: {
                    provider: 'demo'
                }
            };

            // Store demo session
            localStorage.setItem('bizpal-demo-session', JSON.stringify({
                user: demoUser,
                access_token: 'demo-token',
                refresh_token: 'demo-refresh',
                expires_at: Date.now() + (24 * 60 * 60 * 1000)
            }));

            // Set demo flag
            localStorage.setItem('bizpal-demo-mode', 'true');
            localStorage.setItem('onboarding_completed', 'true');

            showResult('demo-test-result', 
                '‚úÖ Demo-konto skapat!<br>' +
                '‚Ä¢ Demo-session lagrad<br>' +
                '‚Ä¢ Demo-l√§ge aktiverat<br>' +
                '‚Ä¢ Onboarding markerat som slutf√∂rd<br>' +
                'Du kan nu g√• till dashboard f√∂r att testa.', 
                'success'
            );
        }

        function testOnboarding() {
            // Clear any existing onboarding data
            localStorage.removeItem('onboarding_completed');
            localStorage.removeItem('bizpal-demo-mode');
            localStorage.removeItem('bizpal-demo-session');
            
            showResult('onboarding-test-result', 
                '‚úÖ Onboarding data rensad!<br>' +
                'G√• till <a href="/onboarding" target="_blank">onboarding</a> f√∂r att testa fl√∂det.', 
                'success'
            );
        }

        function clearOnboarding() {
            localStorage.removeItem('onboarding_completed');
            localStorage.removeItem('bizpal-demo-mode');
            localStorage.removeItem('bizpal-demo-session');
            
            showResult('onboarding-test-result', 
                '‚úÖ All onboarding data rensad!', 
                'success'
            );
        }

        function testDashboard() {
            if (localStorage.getItem('onboarding_completed') === 'true') {
                showResult('dashboard-test-result', 
                    '‚úÖ Onboarding slutf√∂rd!<br>' +
                    'G√• till <a href="/" target="_blank">dashboard</a> f√∂r att testa.', 
                    'success'
                );
            } else {
                showResult('dashboard-test-result', 
                    '‚ö†Ô∏è Onboarding inte slutf√∂rd!<br>' +
                    'Du kommer att omdirigeras till onboarding.', 
                    'error'
                );
            }
        }

        function enableDemoMode() {
            localStorage.setItem('bizpal-demo-mode', 'true');
            showResult('demo-mode-test-result', 
                '‚úÖ Demo-l√§ge aktiverat!<br>' +
                'Ladda om sidan f√∂r att se effekten.', 
                'success'
            );
        }

        function disableDemoMode() {
            localStorage.removeItem('bizpal-demo-mode');
            localStorage.removeItem('bizpal-demo-session');
            showResult('demo-mode-test-result', 
                '‚úÖ Demo-l√§ge inaktiverat!<br>' +
                'Ladda om sidan f√∂r att se effekten.', 
                'success'
            );
        }

        function checkStatus() {
            const onboardingCompleted = localStorage.getItem('onboarding_completed');
            const demoMode = localStorage.getItem('bizpal-demo-mode');
            const demoSession = localStorage.getItem('bizpal-demo-session');
            
            let status = '<strong>Nuvarande status:</strong><br>';
            status += `‚Ä¢ Onboarding slutf√∂rd: ${onboardingCompleted === 'true' ? '‚úÖ Ja' : '‚ùå Nej'}<br>`;
            status += `‚Ä¢ Demo-l√§ge: ${demoMode === 'true' ? '‚úÖ Aktiverat' : '‚ùå Inaktiverat'}<br>`;
            status += `‚Ä¢ Demo-session: ${demoSession ? '‚úÖ Finns' : '‚ùå Saknas'}<br>`;
            
            if (demoSession) {
                try {
                    const sessionData = JSON.parse(demoSession);
                    status += `‚Ä¢ Demo-anv√§ndare: ${sessionData.user?.email || 'Ok√§nd'}<br>`;
                    status += `‚Ä¢ Session utg√•ng: ${new Date(sessionData.expires_at).toLocaleString('sv-SE')}<br>`;
                } catch (e) {
                    status += `‚Ä¢ Demo-session: ‚ö†Ô∏è Felaktig data<br>`;
                }
            }
            
            showResult('status-result', status, 'info');
        }

        // Auto-check status on page load
        window.onload = function() {
            checkStatus();
        };
    </script>
</body>
</html> 